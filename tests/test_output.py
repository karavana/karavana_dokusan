# flake8: noqa

import pytest
from dokusan import entities, output


@pytest.fixture
def sudoku():
    return entities.Sudoku(
        [
            [9, 0, 6, 7, 0, 5, 0, 0, 0],
            [0, 0, 0, 0, 0, 9, 0, 2, 5],
            [7, 4, 0, 0, 0, 1, 0, 0, 0],
            [0, 1, 0, 0, 0, 0, 6, 4, 0],
            [5, 0, 0, 0, 0, 0, 0, 0, 0],
            [8, 6, 9, 1, 0, 0, 3, 0, 0],
            [0, 0, 0, 0, 8, 0, 0, 0, 0],
            [0, 0, 0, 9, 0, 0, 0, 6, 0],
            [0, 0, 0, 4, 0, 3, 1, 0, 0],
        ]
    )


def test_plain(sudoku):
    expected = (
        "┌───┬───┬───╥───┬───┬───╥───┬───┬───┐\n"
        "│ 9 │   │ 6 ║ 7 │   │ 5 ║   │   │   │\n"
        "├───┼───┼───╫───┼───┼───╫───┼───┼───┤\n"
        "│   │   │   ║   │   │ 9 ║   │ 2 │ 5 │\n"
        "├───┼───┼───╫───┼───┼───╫───┼───┼───┤\n"
        "│ 7 │ 4 │   ║   │   │ 1 ║   │   │   │\n"
        "╞═══╪═══╪═══╬═══╪═══╪═══╬═══╪═══╪═══╡\n"
        "│   │ 1 │   ║   │   │   ║ 6 │ 4 │   │\n"
        "├───┼───┼───╫───┼───┼───╫───┼───┼───┤\n"
        "│ 5 │   │   ║   │   │   ║   │   │   │\n"
        "├───┼───┼───╫───┼───┼───╫───┼───┼───┤\n"
        "│ 8 │ 6 │ 9 ║ 1 │   │   ║ 3 │   │   │\n"
        "╞═══╪═══╪═══╬═══╪═══╪═══╬═══╪═══╪═══╡\n"
        "│   │   │   ║   │ 8 │   ║   │   │   │\n"
        "├───┼───┼───╫───┼───┼───╫───┼───┼───┤\n"
        "│   │   │   ║ 9 │   │   ║   │ 6 │   │\n"
        "├───┼───┼───╫───┼───┼───╫───┼───┼───┤\n"
        "│   │   │   ║ 4 │   │ 3 ║ 1 │   │   │\n"
        "└───┴───┴───╨───┴───┴───╨───┴───┴───┘\n"
    )
    assert output.plain(sudoku.puzzle) == expected


def test_colorful(sudoku):
    expected = (
        "┌─────────┬─────────┬─────────╥─────────┬─────────┬─────────╥─────────┬─────────┬─────────┐\n"
        "│         │    \033[93m2\033[0m  \033[93m3\033[0m │         ║         │    \033[93m2\033[0m  \033[93m3\033[0m │         ║         │ \033[93m1\033[0m     \033[93m3\033[0m │ \033[93m1\033[0m     \033[93m3\033[0m │\n"
        "│    \033[;1m9\033[0m    │         │    \033[;1m6\033[0m    ║    \033[;1m7\033[0m    │ \033[93m4\033[0m       │    \033[;1m5\033[0m    ║ \033[93m4\033[0m       │         │ \033[93m4\033[0m       │\n"
        "│         │    \033[93m8\033[0m    │         ║         │         │         ║    \033[93m8\033[0m    │    \033[93m8\033[0m    │    \033[93m8\033[0m    │\n"
        "├─────────┼─────────┼─────────╫─────────┼─────────┼─────────╫─────────┼─────────┼─────────┤\n"
        "│ \033[93m1\033[0m     \033[93m3\033[0m │       \033[93m3\033[0m │ \033[93m1\033[0m     \033[93m3\033[0m ║       \033[93m3\033[0m │       \033[93m3\033[0m │         ║         │         │         │\n"
        "│         │         │         ║       \033[93m6\033[0m │ \033[93m4\033[0m     \033[93m6\033[0m │    \033[;1m9\033[0m    ║ \033[93m4\033[0m       │    \033[;1m2\033[0m    │    \033[;1m5\033[0m    │\n"
        "│         │    \033[93m8\033[0m    │    \033[93m8\033[0m    ║    \033[93m8\033[0m    │         │         ║ \033[93m7\033[0m  \033[93m8\033[0m    │         │         │\n"
        "├─────────┼─────────┼─────────╫─────────┼─────────┼─────────╫─────────┼─────────┼─────────┤\n"
        "│         │         │    \033[93m2\033[0m  \033[93m3\033[0m ║    \033[93m2\033[0m  \033[93m3\033[0m │    \033[93m2\033[0m  \033[93m3\033[0m │         ║         │       \033[93m3\033[0m │       \033[93m3\033[0m │\n"
        "│    \033[;1m7\033[0m    │    \033[;1m4\033[0m    │    \033[93m5\033[0m    ║       \033[93m6\033[0m │       \033[93m6\033[0m │    \033[;1m1\033[0m    ║         │         │       \033[93m6\033[0m │\n"
        "│         │         │    \033[93m8\033[0m    ║    \033[93m8\033[0m    │         │         ║    \033[93m8\033[0m  \033[93m9\033[0m │    \033[93m8\033[0m  \033[93m9\033[0m │    \033[93m8\033[0m  \033[93m9\033[0m │\n"
        "╞═════════╪═════════╪═════════╬═════════╪═════════╪═════════╬═════════╪═════════╪═════════╡\n"
        "│    \033[93m2\033[0m  \033[93m3\033[0m │         │    \033[93m2\033[0m  \033[93m3\033[0m ║    \033[93m2\033[0m  \033[93m3\033[0m │    \033[93m2\033[0m  \033[93m3\033[0m │    \033[93m2\033[0m    ║         │         │    \033[93m2\033[0m    │\n"
        "│         │    \033[;1m1\033[0m    │         ║    \033[93m5\033[0m    │    \033[93m5\033[0m    │         ║    \033[;1m6\033[0m    │    \033[;1m4\033[0m    │         │\n"
        "│         │         │ \033[93m7\033[0m       ║    \033[93m8\033[0m    │ \033[93m7\033[0m     \033[93m9\033[0m │ \033[93m7\033[0m  \033[93m8\033[0m    ║         │         │ \033[93m7\033[0m  \033[93m8\033[0m  \033[93m9\033[0m │\n"
        "├─────────┼─────────┼─────────╫─────────┼─────────┼─────────╫─────────┼─────────┼─────────┤\n"
        "│         │    \033[93m2\033[0m  \033[93m3\033[0m │    \033[93m2\033[0m  \033[93m3\033[0m ║    \033[93m2\033[0m  \033[93m3\033[0m │    \033[93m2\033[0m  \033[93m3\033[0m │    \033[93m2\033[0m    ║    \033[93m2\033[0m    │ \033[93m1\033[0m       │ \033[93m1\033[0m  \033[93m2\033[0m    │\n"
        "│    \033[;1m5\033[0m    │         │ \033[93m4\033[0m       ║       \033[93m6\033[0m │ \033[93m4\033[0m     \033[93m6\033[0m │ \033[93m4\033[0m     \033[93m6\033[0m ║         │         │         │\n"
        "│         │ \033[93m7\033[0m       │ \033[93m7\033[0m       ║    \033[93m8\033[0m    │ \033[93m7\033[0m     \033[93m9\033[0m │ \033[93m7\033[0m  \033[93m8\033[0m    ║ \033[93m7\033[0m  \033[93m8\033[0m  \033[93m9\033[0m │ \033[93m7\033[0m  \033[93m8\033[0m  \033[93m9\033[0m │ \033[93m7\033[0m  \033[93m8\033[0m  \033[93m9\033[0m │\n"
        "├─────────┼─────────┼─────────╫─────────┼─────────┼─────────╫─────────┼─────────┼─────────┤\n"
        "│         │         │         ║         │    \033[93m2\033[0m    │    \033[93m2\033[0m    ║         │         │    \033[93m2\033[0m    │\n"
        "│    \033[;1m8\033[0m    │    \033[;1m6\033[0m    │    \033[;1m9\033[0m    ║    \033[;1m1\033[0m    │ \033[93m4\033[0m  \033[93m5\033[0m    │ \033[93m4\033[0m       ║    \033[;1m3\033[0m    │    \033[93m5\033[0m    │         │\n"
        "│         │         │         ║         │ \033[93m7\033[0m       │ \033[93m7\033[0m       ║         │ \033[93m7\033[0m       │ \033[93m7\033[0m       │\n"
        "╞═════════╪═════════╪═════════╬═════════╪═════════╪═════════╬═════════╪═════════╪═════════╡\n"
        "│ \033[93m1\033[0m  \033[93m2\033[0m  \033[93m3\033[0m │    \033[93m2\033[0m  \033[93m3\033[0m │ \033[93m1\033[0m  \033[93m2\033[0m  \033[93m3\033[0m ║    \033[93m2\033[0m    │         │    \033[93m2\033[0m    ║    \033[93m2\033[0m    │       \033[93m3\033[0m │    \033[93m2\033[0m  \033[93m3\033[0m │\n"
        "│ \033[93m4\033[0m     \033[93m6\033[0m │    \033[93m5\033[0m    │ \033[93m4\033[0m  \033[93m5\033[0m    ║    \033[93m5\033[0m  \033[93m6\033[0m │    \033[;1m8\033[0m    │       \033[93m6\033[0m ║ \033[93m4\033[0m  \033[93m5\033[0m    │    \033[93m5\033[0m    │ \033[93m4\033[0m       │\n"
        "│         │ \033[93m7\033[0m     \033[93m9\033[0m │ \033[93m7\033[0m       ║         │         │ \033[93m7\033[0m       ║ \033[93m7\033[0m     \033[93m9\033[0m │ \033[93m7\033[0m     \033[93m9\033[0m │ \033[93m7\033[0m     \033[93m9\033[0m │\n"
        "├─────────┼─────────┼─────────╫─────────┼─────────┼─────────╫─────────┼─────────┼─────────┤\n"
        "│ \033[93m1\033[0m  \033[93m2\033[0m  \033[93m3\033[0m │    \033[93m2\033[0m  \033[93m3\033[0m │ \033[93m1\033[0m  \033[93m2\033[0m  \033[93m3\033[0m ║         │ \033[93m1\033[0m  \033[93m2\033[0m    │    \033[93m2\033[0m    ║    \033[93m2\033[0m    │         │    \033[93m2\033[0m  \033[93m3\033[0m │\n"
        "│ \033[93m4\033[0m       │    \033[93m5\033[0m    │ \033[93m4\033[0m  \033[93m5\033[0m    ║    \033[;1m9\033[0m    │    \033[93m5\033[0m    │         ║ \033[93m4\033[0m  \033[93m5\033[0m    │    \033[;1m6\033[0m    │ \033[93m4\033[0m       │\n"
        "│         │ \033[93m7\033[0m  \033[93m8\033[0m    │ \033[93m7\033[0m  \033[93m8\033[0m    ║         │ \033[93m7\033[0m       │ \033[93m7\033[0m       ║ \033[93m7\033[0m  \033[93m8\033[0m    │         │ \033[93m7\033[0m  \033[93m8\033[0m    │\n"
        "├─────────┼─────────┼─────────╫─────────┼─────────┼─────────╫─────────┼─────────┼─────────┤\n"
        "│    \033[93m2\033[0m    │    \033[93m2\033[0m    │    \033[93m2\033[0m    ║         │    \033[93m2\033[0m    │         ║         │         │    \033[93m2\033[0m    │\n"
        "│       \033[93m6\033[0m │    \033[93m5\033[0m    │    \033[93m5\033[0m    ║    \033[;1m4\033[0m    │    \033[93m5\033[0m  \033[93m6\033[0m │    \033[;1m3\033[0m    ║    \033[;1m1\033[0m    │    \033[93m5\033[0m    │         │\n"
        "│         │ \033[93m7\033[0m  \033[93m8\033[0m  \033[93m9\033[0m │ \033[93m7\033[0m  \033[93m8\033[0m    ║         │ \033[93m7\033[0m       │         ║         │ \033[93m7\033[0m  \033[93m8\033[0m  \033[93m9\033[0m │ \033[93m7\033[0m  \033[93m8\033[0m  \033[93m9\033[0m │\n"
        "└─────────┴─────────┴─────────╨─────────┴─────────┴─────────╨─────────┴─────────┴─────────┘\n"
    )
    assert output.colorful(sudoku) == expected
